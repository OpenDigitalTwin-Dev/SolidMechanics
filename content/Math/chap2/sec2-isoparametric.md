# 等参变换

[前文](./intro.md)提到，物理单元上的计算关键在于单元 $E$ 上的积分运算和场变量分布运算。然而，由于 $\left.\phi\right|_{E}$ 与单元 $E$ 的几何形状密切相关，其构造过程复杂且难以统一处理。为了解决这一问题，引入了参考单元和形函数，将物理单元上的计算变换到参考单元上进行

在有限元方法中，物理单元与参考单元通过参数化映射实现积分运算与场变量分布运算的规范化处理：

- 几何映射：通过形函数将物理单元坐标 $(x,y)$ 映射到参考单元坐标 $(\xi, \eta)$：

```{margin}
$(x_{i},y_{i})$ 是物理单元节点的坐标
```

$$
\begin{equation}
x = \sum_{i} N_{i}(\xi,\eta)x_{i},\quad y = \sum_{i} N_{i}(\xi,\eta)y_{i}.
\end{equation}
$$

几何映射的核心目的是将不规则物理单元的积分运算转化为参考单元上的规则域积分

- 场变量插值：通过形函数在参考单元上对场变量插值

```{margin}
$u_{i}$ 是物理单元节点的物理量取值
```

$$
u(x,y)=\sum_{i}N_{i}(\xi,\eta)u_{i}.
$$

场变量插值的核心目的是建立节点值与连续场之间的数学关联，从而支持物理量（如应变、应力）的梯度计算


根据几何映射和场变量插值中所使用形函数阶次的差异，可分为等参变换和非等参变换

| **方法名称**       | **等参变换**                                              | **非等参变换度** | 
|:---------:|:--------------:|:--------:|
| **形函数一致性** | 几何映射与场变量使用相同阶数形函数 | 几何映射与场变量使用不同阶数形函数            | 
| **计算精度**     | 高（几何映射与场变量插值精度匹配）  |  几何映射精度可能低于场变量插值精度            |
| **适用场景**        | 曲边单元、高阶场分析（如二次单元） | 简单几何+高阶场（如线性网格+二次温度场）           |
| **计算复杂度**      | 较高（需处理高阶雅可比矩阵）  | 较低（几何映射简单）           |


## 积分运算

通过坐标变换，物理单元上的积分通过参考单元计算

$$
\int_{E_\text{物理}}f(x,y)\mathrm{d}x\mathrm{d}y=\int_{E_\text{参考}}f(\xi,\eta)\cdot\left|\det \mathbf{J}\right|\mathrm{d}\xi\mathrm{d}\eta,
$$

其中雅可比矩阵

$$
\begin{equation}
\mathbf{J} = \frac{\partial (x,y)}{\partial (\xi,\eta)}=\left[
\begin{matrix}
\frac{\partial x}{\xi} & \frac{\partial x}{\eta} \\
\frac{\partial y}{\xi} & \frac{\partial y}{\eta} 
\end{matrix}
\right].
\end{equation}
$$