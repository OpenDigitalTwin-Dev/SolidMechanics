# 数值方法简介

```{margin}
例如，在前面章节介绍的平面应力/应变问题中，物理量之间的关系便以偏微分方程的形式呈现
```

在科学与工程领域，许多实际问题都可以通过物理方程进行建模，例如结构受力分析、热传导、流体流动和电磁场分布等。这些物理方程通常以 <b>偏微分方程（PDE）</b>的形式描述系统的基本规律，将复杂的自然现象抽象为数学模型。

然而，由于实际问题常伴随**复杂的几何形状、边界条件、非线性效应以及材料的非均匀性**，这些方程的**解析解**往往难以求得。
此时，数值求解方法成为连接理论模型与实际应用的关键工具，通过**离散化**和**数值计算**求解物理方程，为实际问题提供解决方案并支撑科学预测

有限差分法（FDM）、有限元法（FEM）和有限体积法（FVM）是求解偏微分方程的三大数值方法，各自具有独特的优势和适用场景：
1. **有限差分法**：算法简单、计算效率高，适用于规则网格和简单几何问题，广泛应用于热传导、波动方程等简单物理问题
2. **有限元法**：具有高度灵活性，能够处理复杂几何、非线性问题和异质材料，但实现较为复杂，计算量较大；广泛应用于固体力学、结构分析、电磁场等需要精细建模的领域
3. **有限体积法**：严格满足局部守恒性，并具有良好的网格适应性，特别适合计算流体力学（CFD）和传热学等守恒律问题

接下来通过一个简单的例子，描述三种数值方法的核心思想

## 问题描述

```{figure} ../../images/chap1/1D-example.png
---
width: 400px
name: sec9-fig:1D-example
---
一维均匀弹性杆
```

考虑一根长度为 $L$ 的均匀弹性杆，受力后在长度方向上的位移 $u(x)$ 满足以下控制方程：

```{margin}
该方程可通过平面应力问题，按位移求解方程 {eq}`sec8-eq:solution-displ` 进一步简化成一维问题得到
```

$$
\frac{\partial^2 u}{\partial x^2} + f(x) = 0,\quad 0\leq x \leq L
$$ (sec9-eq:example)

其中 

1. $f(x)$ 为分布载荷，不考虑体积力
2. 左端固定：$u(0)=0$，右端固定位移：$u(L)=u_{L}$

如果 $f(x)$ 恒等于常数 $-C$，则方程 {eq}`sec9-eq:example` 是容易求得的，它具有形式

$$
u(x) = Cx^2 + c_{1}x + c_{0}
$$

代入边界条件：$u(0)=0$ 和 $u(L)=u_{L}$，得到

$$
c_{0} = 0,\quad c_{1} = \frac{u_{L}-cL^2}{L}.
$$

如果 $f(x)$ 的形式较为复杂，此时则无法得到 $u(x)$ 的解析表达式，这时需要借助数值求解的手段：

将计算区域划分为若干个**网格单元**，如图所示，长度为 $L$ 的线段被均匀划分为五个单元，每个单元的长度为 $h$，然后**在单元内部或单元节点上离散化控制方程，结合边界条件来求解目标方程**

## 有限差分法

有限差分方法的基本思路是利用差分公式**对导数进行离散化近似**，从而将偏微分方程转化为**代数方程**，例如一阶差分

```{margin}
记 $u(x_{n}) = u_{n}$，$f(x_{n}) = f_{n}$
```

$$
\left.\frac{\partial u}{\partial x}\right|_{x_{2}} = \frac{u_3-u_1}{h} + o(h)\approx \frac{u_3-u_1}{h}.
$$

对于二阶导数，通常采用中心差分近似，即

$$
\begin{equation}
\begin{aligned}
\left.\frac{\partial^2 u}{\partial x^2}\right|_{x_{n}}&\approx
\frac{u_{n+1} - 2\,u_{n} + u_{n-1}}{h^2}
\end{aligned}
\end{equation}
$$ (sec9-eq:fdm-1)

令方程 {eq}`sec9-eq:example` 在除边界节点外的每一个网格节点 $x_{n}$ 上满足，则得到关于 $u_{n}$ 的代数方程组

$$
\frac{u_{n+1} - 2\,u_{n} + u_{n-1}}{h^2} + f_n = 0,\quad n=1,2,3,4\\
$$ (sec9-eq:fdm-2)

将边界条件

$$
u_0 = 0,\quad u_5 = u_L
$$

代入到方程 {eq}`sec9-eq:fdm-2` 中，于是共四个求解方程和四个求解变量，写成矩阵形式为

```{margin}
这是一个稀疏矩阵（非零元数量稀少），常使用迭代法进行求解
```

$$
\begin{equation}
\frac{1}{h^2}\left[
\begin{matrix}
-2 & 1 & & \\
1 & -2 & 1 & \\
  & 1  & -2 & 1 \\
  & & 1 & 2
\end{matrix}\right]
\left[
\begin{matrix}
u_1 \\ u_2 \\ u_3 \\ u_4
\end{matrix}\right]=
\left[
\begin{matrix}
-f_1 - \frac{0}{h^2} \\ -f_2 \\ -f_3 \\ -f_4 - \frac{u_L}{h^2}
\end{matrix}\right]
\end{equation}
$$ (sec9-eq:fdm-3)

通过求解代数方程组 {eq}`sec9-eq:fdm-3`，可以得到 $u(x)$ 在点 $x_{1},x_{2},x_{3},x_{4}$ 的近似值。$u(x)$在其它位置的值通常可以通过已知网格节点的值**插值**得到

可以预见，随着 $h \to 0$，方程 {eq}`sec9-eq:fdm-1` 左端与右端的近似精度逐渐提高，线性方程组 {eq}`sec9-eq:fdm-2` 的解将越来越接近方程 {eq}`sec9-eq:example` 的真解

## 有限元法

有限元法的核心思想是将计算区域划分为若干单元，**在每个单元上选取简单的插值函数来近似真解**，并通过离散化和组装形成整体方程，从而求解原问题的近似解

### 弱形式

```{margin}
光滑性：函数的高阶导数存在且连续。例如，若 $f(x)$ 连续，则要求 $u(x)$ 的二阶导数连续
```

方程 {eq}`sec9-eq:example` 被称为问题的**强形式**，因为它要求解函数 $u(x)$ 在定义域内严格满足给定的微分方程及其边界条件。这意味着 $u(x)$ 必须具备足够的**光滑性**，以确保微分运算和边界条件的精确成立

在实际问题中，材料的不连续性、载荷的突变或几何的奇异点通常会导致**强解**（经典解）不存在或无法满足光滑性要求。**弱形式**通过将微分方程转化为**积分形式**，降低了解函数的光滑性要求，从而能够在**更广泛的函数空间**（如有限元函数空间）中寻求近似解，更有效地**逼近**问题的真实解

选择试验函数 $v(x)\in \mathcal{V}$，$\mathcal{V}$ 是某个选定的函数空间，因此方程 {eq}`sec9-eq:example` 的弱形式为

$$
\int_{0}^{L}\left(\frac{\partial^2 u}{\partial x^2} + f(x)\right)\cdot v(x) \, \mathrm{d}x = 0,\quad v(x)\in \mathcal{V}.
$$ (sec9-eq:fem-1)

显然，如果 $\mathcal{V}$ 选为全函数空间，则此时弱形式 {eq}`sec9-eq:fem-1` 与强形式 {eq}`sec9-eq:example` 是等价的，因为此时可以选择

$$
v = \frac{\partial^2 u}{\partial x^2} + f(x),
$$

将其代入到弱形式中，由连续性要求得到 $\frac{\partial^2 u}{\partial x^2} + f(x) \equiv 0, x\in [0,L]$。

弱形式 {eq}`sec9-eq:fem-1` 可以理解为方程 {eq}`sec9-eq:example` 在某个函数空间 $\mathcal{V}$ 的**投影**为 0。可以想象，函数空间 $\mathcal{V}$ 越大，就越接近于全空间，弱形式的解也就越接近于真解

因此，在有限元方法中，试验函数空间 $\mathcal{V}$ 的选择至关重要。它不仅需要具备良好的逼近能力，以确保解的精度，还应具有易于数值计算的特性，从而提高计算效率。通常情况下，$\mathcal{V}$ 会被选为**分片多项式函数空间**



## 有限体积法
